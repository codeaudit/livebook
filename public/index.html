<html>
<head>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <script src="//cdn.opalrb.org/opal/master/opal.min.js"></script>
  <script src="//cdn.opalrb.org/opal/master/opal-parser.min.js"></script>
  <script src="/ace-editor/ace.js"></script>
  <script src="/d3/d3.js"></script>
  <script src="/app.js"></script>
</head>
<body>
<div id="notebook">

  <div class="cell prose">
    <h1>Fallout character progress analysis</h1>
    <p>by Orion Henry, Aug 2015</p>
  </div>

  <div class="cell" id="code">
  <div class="cell" id="editor">data = load("fallout.csv")
data.each do |d|
  d["Minutes"] = d["Duration"].split(":").reverse.zip([1,60,60*24]).inject(0) {
    |sum,n| sum + n[0].to_i * n[1]
  }
  d["CapsPerHour"] = (d["Caps"] * 60 / d["Minutes"]).round(2)
end
plot(data,"L","CapsPerHour")</div>
  </div>

  <div class="cell" id="plot"></div>

  <div class="cell" id="data"></div>

  <script>
    // initialize ace editor
    var editor = ace.edit("editor");
    editor.getSession().setMode("ace/mode/ruby");
    editor.getSession().getSelection().selectionLead.setPosition(2, 0); // cursor at end
    editor.on("change",function() { _magic_eval(editor.getValue()); })

    _magic_eval(editor.getValue())

  </script>

</div>
</body>
</html>
